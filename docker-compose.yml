version: "3.8"

services:
    dripstock:
        build: .
        ports:
            - "3001:3001" # Backend API
            - "5173:5173" # Frontend dev server
        environment:
            - NODE_ENV=development
            - PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium
        volumes:
            # Persist node_modules in named volumes for faster rebuilds
            - root_node_modules:/app/node_modules
            - frontend_node_modules:/app/frontend/node_modules
            - backend_node_modules:/app/backend/node_modules
        restart: unless-stopped

volumes:
    root_node_modules:
    frontend_node_modules:
    backend_node_modules:
